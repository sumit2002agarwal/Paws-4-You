{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\win11\\\\Desktop\\\\adopet\\\\frontend\\\\src\\\\contexts\\\\auth.js\",\n    _s = $RefreshSig$();\n\n// dependencies\nimport { createContext, useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport Cookies from \"universal-cookie\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\n\nconst UserStateProvider = props => {\n  _s();\n\n  const [state, setState] = useState({});\n  const navigate = useNavigate();\n\n  const checkLoggedIn = async () => {\n    const cookies = new Cookies();\n    const token = cookies.get(\"jwtoken\");\n\n    try {\n      const res = await fetch(\"http://localhost:5000/afterlogin\", {\n        method: \"GET\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`\n        }\n      });\n\n      if (res.status === 401) {\n        const error = new Error(res.error);\n        throw error;\n      }\n\n      const data = await res.json();\n      setState({\n        state\n      });\n    } catch (err) {\n      console.log(err);\n      navigate(\"/login\");\n    }\n  };\n\n  useEffect(() => {\n    checkLoggedIn();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(UserStateProvider.Provider, {\n    value: {\n      state,\n      checkLoggedIn\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 5\n  }, this);\n};\n\n_s(UserStateProvider, \"liOsP3NGB/PaRwqsM/Z7HqbhK5M=\", false, function () {\n  return [useNavigate];\n});\n\n_c = UserStateProvider;\nexport default UserStateProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserStateProvider\");","map":{"version":3,"names":["createContext","useState","useEffect","useNavigate","Cookies","AuthContext","UserStateProvider","props","state","setState","navigate","checkLoggedIn","cookies","token","get","res","fetch","method","headers","Accept","Authorization","status","error","Error","data","json","err","console","log","children"],"sources":["C:/Users/win11/Desktop/adopet/frontend/src/contexts/auth.js"],"sourcesContent":["// dependencies\r\nimport { createContext, useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport Cookies from \"universal-cookie\";\r\n\r\nexport const AuthContext = createContext();\r\n\r\n\r\n\r\nconst UserStateProvider = (props) => {\r\n  const [state, setState] = useState({});\r\n  const navigate = useNavigate();\r\n  const checkLoggedIn = async () => {\r\n\r\n\tconst cookies = new Cookies();\r\n\tconst token = cookies.get(\"jwtoken\");\r\n\ttry {\r\n\t\tconst res = await fetch(\"http://localhost:5000/afterlogin\", {\r\n\t\tmethod: \"GET\",\r\n\t\theaders: {\r\n\t\tAccept: \"application/json\",\r\n\t\t\"Content-Type\": \"application/json\",\r\n\t\tAuthorization: `Bearer ${token}`,\r\n\t\t},\r\n\t\t\r\n\t});\r\n\tif (res.status === 401) {\r\n\r\n\t\tconst error = new Error(res.error);\r\n\t\tthrow error;\r\n\t  }\r\n\t\tconst data = await res.json();\r\n\t\t\r\n\t\tsetState({state});\r\n\t\t \r\n\t\t  \r\n\t\t\r\n\t  } catch (err) {\r\n\t\tconsole.log(err);\r\n\t\tnavigate(\"/login\");\r\n\t\t\r\n\t\t\r\n\t  }\r\n};\r\n\r\n\r\n  useEffect(() => {\r\n\tcheckLoggedIn();\r\n  }, []);\r\n\r\n  return (\r\n    <UserStateProvider.Provider value={{state, checkLoggedIn}}>{props.children}</UserStateProvider.Provider>\r\n  );\r\n};\r\n\r\nexport default UserStateProvider;"],"mappings":";;;AAAA;AACA,SAASA,aAAT,EAAwBC,QAAxB,EAAkCC,SAAlC,QAAmD,OAAnD;AACA,SAASC,WAAT,QAA4B,kBAA5B;AACA,OAAOC,OAAP,MAAoB,kBAApB;;AAEA,OAAO,MAAMC,WAAW,gBAAGL,aAAa,EAAjC;;AAIP,MAAMM,iBAAiB,GAAIC,KAAD,IAAW;EAAA;;EACnC,MAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBR,QAAQ,CAAC,EAAD,CAAlC;EACA,MAAMS,QAAQ,GAAGP,WAAW,EAA5B;;EACA,MAAMQ,aAAa,GAAG,YAAY;IAEnC,MAAMC,OAAO,GAAG,IAAIR,OAAJ,EAAhB;IACA,MAAMS,KAAK,GAAGD,OAAO,CAACE,GAAR,CAAY,SAAZ,CAAd;;IACA,IAAI;MACH,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,kCAAD,EAAqC;QAC5DC,MAAM,EAAE,KADoD;QAE5DC,OAAO,EAAE;UACTC,MAAM,EAAE,kBADC;UAET,gBAAgB,kBAFP;UAGTC,aAAa,EAAG,UAASP,KAAM;QAHtB;MAFmD,CAArC,CAAvB;;MASD,IAAIE,GAAG,CAACM,MAAJ,KAAe,GAAnB,EAAwB;QAEvB,MAAMC,KAAK,GAAG,IAAIC,KAAJ,CAAUR,GAAG,CAACO,KAAd,CAAd;QACA,MAAMA,KAAN;MACE;;MACF,MAAME,IAAI,GAAG,MAAMT,GAAG,CAACU,IAAJ,EAAnB;MAEAhB,QAAQ,CAAC;QAACD;MAAD,CAAD,CAAR;IAIE,CArBH,CAqBI,OAAOkB,GAAP,EAAY;MACfC,OAAO,CAACC,GAAR,CAAYF,GAAZ;MACAhB,QAAQ,CAAC,QAAD,CAAR;IAGE;EACH,CA/BC;;EAkCAR,SAAS,CAAC,MAAM;IACjBS,aAAa;EACX,CAFQ,EAEN,EAFM,CAAT;EAIA,oBACE,QAAC,iBAAD,CAAmB,QAAnB;IAA4B,KAAK,EAAE;MAACH,KAAD;MAAQG;IAAR,CAAnC;IAAA,UAA4DJ,KAAK,CAACsB;EAAlE;IAAA;IAAA;IAAA;EAAA,QADF;AAGD,CA5CD;;GAAMvB,iB;UAEaH,W;;;KAFbG,iB;AA8CN,eAAeA,iBAAf"},"metadata":{},"sourceType":"module"}
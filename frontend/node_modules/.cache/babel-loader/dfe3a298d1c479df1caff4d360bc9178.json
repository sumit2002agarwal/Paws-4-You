{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/win11/Desktop/adopet/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/win11/Desktop/adopet/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/win11/Desktop/adopet/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,createContext}from'react';import useState from'react-usestateref';import Cookies from\"universal-cookie\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";var UserContext=/*#__PURE__*/createContext();export var UserProvider=function UserProvider(_ref){var children=_ref.children;var navigate=useNavigate();var _useState=useState({name:null,email:null}),_useState2=_slicedToArray(_useState,3),currentUser=_useState2[0],setCurrentUser=_useState2[1],reff=_useState2[2];var cookies=new Cookies();var token=cookies.get(\"jwtoken\");useEffect(function(){var checkLoggedIn=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res,error,data,em,nam;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"http://localhost:5000/afterlogin\",{method:\"GET\",headers:{Accept:\"application/json\",\"Content-Type\":\"application/json\",Authorization:\"Bearer \".concat(token)}});case 3:res=_context.sent;if(!(res.status===401)){_context.next=7;break;}error=new Error(res.error);throw error;case 7:_context.next=9;return res.json();case 9:data=_context.sent;em=data.email;nam=data.name;setCurrentUser({name:nam,email:em});_context.next=18;break;case 15:_context.prev=15;_context.t0=_context[\"catch\"](0);console.log(_context.t0);// navigate(\"/login\");\ncase 18:case\"end\":return _context.stop();}}},_callee,null,[[0,15]]);}));return function checkLoggedIn(){return _ref2.apply(this,arguments);};}();checkLoggedIn();},[]);return/*#__PURE__*/_jsx(UserContext.Provider,{value:{currentUser:currentUser,setCurrentUser:setCurrentUser,reff:reff},children:children});};export default UserContext;","map":{"version":3,"names":["React","useEffect","createContext","useState","Cookies","useNavigate","UserContext","UserProvider","children","navigate","name","email","currentUser","setCurrentUser","reff","cookies","token","get","checkLoggedIn","fetch","method","headers","Accept","Authorization","res","status","error","Error","json","data","em","nam","console","log"],"sources":["C:/Users/win11/Desktop/adopet/frontend/src/contexts/usercontext.js"],"sourcesContent":["import React, { useEffect, createContext } from 'react';\r\nimport useState from 'react-usestateref'\r\nimport Cookies from \"universal-cookie\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nconst UserContext = createContext();\r\n\r\nexport const UserProvider = ({ children }) => {\r\n\r\n\tconst navigate = useNavigate();\r\n\tconst [ currentUser, setCurrentUser,reff ] = useState({\r\n\t\tname: null,\r\n    email: null,\r\n\r\n\t});\r\n\t\r\n\tconst cookies = new Cookies();\r\n\tconst token = cookies.get(\"jwtoken\");\r\n\tuseEffect(() => {\r\n\t\tconst checkLoggedIn = async () => {\r\n\t\t\t\r\n\r\n\t\t\ttry {\r\n\t\t\t\t\t\tconst res = await fetch(\"http://localhost:5000/afterlogin\", {\r\n\t\t\t\tmethod: \"GET\",\r\n\t\t\t\theaders: {\r\n\t\t\t\tAccept: \"application/json\",\r\n\t\t\t\t\"Content-Type\": \"application/json\",\r\n\t\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\t\t},\r\n\t\t\t\t\r\n\t\t\t});\r\n\t\t\tif (res.status === 401) {\r\n      \r\n\t\t\t\tconst error = new Error(res.error);\r\n\t\t\t\tthrow error;\r\n\t\t\t  }\r\n\t\t\t\tconst data = await res.json();\r\n\t\t\t\tconst em=data.email;\r\n\t\t\t\tconst nam=data.name;\r\n\t\t\t\tsetCurrentUser({\r\n\r\n\t\t\t\t\t\tname: nam,\r\n                       email: em,\r\n\t\t\t\t\t});\r\n\t\t\t\t \r\n\t\t\t\t  \r\n\t\t\t\t\r\n\t\t\t  } catch (err) {\r\n\t\t\t\tconsole.log(err);\r\n               // navigate(\"/login\");\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t  }\r\n\t\t};\r\n\r\n\t\tcheckLoggedIn();\r\n\t}, []);\r\n\r\n\t\r\n\treturn (\r\n\t\t<UserContext.Provider value={{currentUser, setCurrentUser,reff}}>\r\n\t\t\t{ children}\r\n\t\t</UserContext.Provider>\r\n\t);\r\n};\r\n\r\n\r\nexport default UserContext;"],"mappings":"oYAAA,MAAOA,MAAP,EAAgBC,SAAhB,CAA2BC,aAA3B,KAAgD,OAAhD,CACA,MAAOC,SAAP,KAAqB,mBAArB,CACA,MAAOC,QAAP,KAAoB,kBAApB,CACA,OAASC,WAAT,KAA4B,kBAA5B,C,2CACA,GAAMC,YAAW,cAAGJ,aAAa,EAAjC,CAEA,MAAO,IAAMK,aAAY,CAAG,QAAfA,aAAe,MAAkB,IAAfC,SAAe,MAAfA,QAAe,CAE7C,GAAMC,SAAQ,CAAGJ,WAAW,EAA5B,CACA,cAA6CF,QAAQ,CAAC,CACrDO,IAAI,CAAE,IAD+C,CAEnDC,KAAK,CAAE,IAF4C,CAAD,CAArD,wCAAQC,WAAR,eAAqBC,cAArB,eAAoCC,IAApC,eAMA,GAAMC,QAAO,CAAG,GAAIX,QAAJ,EAAhB,CACA,GAAMY,MAAK,CAAGD,OAAO,CAACE,GAAR,CAAY,SAAZ,CAAd,CACAhB,SAAS,CAAC,UAAM,CACf,GAAMiB,cAAa,6FAAG,qMAIAC,MAAK,CAAC,kCAAD,CAAqC,CAC9DC,MAAM,CAAE,KADsD,CAE9DC,OAAO,CAAE,CACTC,MAAM,CAAE,kBADC,CAET,eAAgB,kBAFP,CAGTC,aAAa,kBAAYP,KAAZ,CAHJ,CAFqD,CAArC,CAJL,QAIZQ,GAJY,oBAajBA,GAAG,CAACC,MAAJ,GAAe,GAbE,0BAedC,KAfc,CAeN,GAAIC,MAAJ,CAAUH,GAAG,CAACE,KAAd,CAfM,MAgBdA,MAhBc,8BAkBDF,IAAG,CAACI,IAAJ,EAlBC,QAkBdC,IAlBc,eAmBdC,EAnBc,CAmBXD,IAAI,CAAClB,KAnBM,CAoBdoB,GApBc,CAoBVF,IAAI,CAACnB,IApBK,CAqBpBG,cAAc,CAAC,CAEbH,IAAI,CAAEqB,GAFO,CAGIpB,KAAK,CAAEmB,EAHX,CAAD,CAAd,CArBoB,iFA8BpBE,OAAO,CAACC,GAAR,cACW;AA/BS,qEAAH,kBAAbf,cAAa,2CAAnB,CAqCAA,aAAa,GACb,CAvCQ,CAuCN,EAvCM,CAAT,CA0CA,mBACC,KAAC,WAAD,CAAa,QAAb,EAAsB,KAAK,CAAE,CAACN,WAAW,CAAXA,WAAD,CAAcC,cAAc,CAAdA,cAAd,CAA6BC,IAAI,CAAJA,IAA7B,CAA7B,UACGN,QADH,EADD,CAKA,CA1DM,CA6DP,cAAeF,YAAf"},"metadata":{},"sourceType":"module"}
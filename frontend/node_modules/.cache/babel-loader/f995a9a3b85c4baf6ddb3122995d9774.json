{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\win11\\\\Desktop\\\\adopet\\\\frontend\\\\src\\\\contexts\\\\auth.js\",\n    _s = $RefreshSig$();\n\n// dependencies\nimport { createContext, useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport Cookies from \"universal-cookie\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\n/*\r\n\r\n    const login = async(email, password,usertype) => {\r\n\r\n        const res = await fetch(\"http://localhost:5000/login\", {\r\n\t\t  method: \"POST\",\r\n\t\t  headers: {\r\n\t\t\t\"Content-Type\": \"application/json\",\r\n\t\t  },\r\n\t\t  //credentials: 'include',\r\n\t\t  body: JSON.stringify({\r\n\t\t\temail,\r\n\t\t\tpassword,\r\n\t\t\tusertype\r\n\t\t  }),\r\n\t\t});\r\n\t\r\n\t\tconst dataa = await res.json();\r\n       \r\n         console.log(dataa);\r\n\t\t\r\n\t\t cookies.set(\"jwtoken\", dataa.token, {\r\n\t\t\texpires: new Date(Date.now() + 25892000000),\r\n\t\t\t//httpOnly: true,\r\n\t\t\tpath: \"/\",\r\n\t\t  });\r\n\t\t  \r\n\t\t  \r\n\t\tif (dataa.status === 400 || !dataa || dataa.error) {\r\n\t\t   window.alert(\"inSuccessfull login\");\r\n        console.log(\"inSuccessfull login\");\r\n\t\t\t\r\n\t\t\r\n\t\t} else {\r\n\t\t\tconsole.log(dataa.data);\r\n\t\t\tsetUser(dataa.data);\r\n\t\t\tconsole.log(usertype);\r\n\t\t\tif(usertype==\"2\")\r\n\t\t\tnavigate(\"/home\");\r\n\t\t\telse\r\n\t\t\tnavigate(\"/adminhome\")\r\n\t\t    window.alert(\"Successfull login\");\r\n        console.log(\"Successfull login\");\r\n\t\t\r\n\t\t}\r\n\r\n\r\n\r\n    };\r\n\r\n \r\n\r\n*/\n\nconst UserStateProvider = props => {\n  _s();\n\n  const [state, setState] = useState({});\n\n  const checkLoggedIn = async () => {\n    const cookies = new Cookies();\n    const token = cookies.get(\"jwtoken\");\n\n    try {\n      const res = await fetch(\"http://localhost:5000/afterlogin\", {\n        method: \"GET\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`\n        }\n      });\n\n      if (res.status === 401) {\n        const error = new Error(res.error);\n        throw error;\n      }\n\n      const data = await res.json();\n      setState({\n        state\n      });\n    } catch (err) {\n      console.log(err);\n      navigate(\"/login\");\n    }\n  };\n\n  useEffect(() => {\n    checkLoggedIn();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n    value: {\n      state,\n      checkLoggedIn\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 104,\n    columnNumber: 5\n  }, this);\n};\n\n_s(UserStateProvider, \"d/109zsnYLOF9M9RLxKBdAExSLI=\");\n\n_c = UserStateProvider;\nexport default UserStateProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserStateProvider\");","map":{"version":3,"names":["createContext","useState","useEffect","useNavigate","Cookies","AuthContext","UserStateProvider","props","state","setState","checkLoggedIn","cookies","token","get","res","fetch","method","headers","Accept","Authorization","status","error","Error","data","json","err","console","log","navigate","children"],"sources":["C:/Users/win11/Desktop/adopet/frontend/src/contexts/auth.js"],"sourcesContent":["// dependencies\r\nimport { createContext, useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport Cookies from \"universal-cookie\";\r\n\r\nexport const AuthContext = createContext();\r\n\r\n/*\r\n\r\n    const login = async(email, password,usertype) => {\r\n\r\n        const res = await fetch(\"http://localhost:5000/login\", {\r\n\t\t  method: \"POST\",\r\n\t\t  headers: {\r\n\t\t\t\"Content-Type\": \"application/json\",\r\n\t\t  },\r\n\t\t  //credentials: 'include',\r\n\t\t  body: JSON.stringify({\r\n\t\t\temail,\r\n\t\t\tpassword,\r\n\t\t\tusertype\r\n\t\t  }),\r\n\t\t});\r\n\t\r\n\t\tconst dataa = await res.json();\r\n       \r\n         console.log(dataa);\r\n\t\t\r\n\t\t cookies.set(\"jwtoken\", dataa.token, {\r\n\t\t\texpires: new Date(Date.now() + 25892000000),\r\n\t\t\t//httpOnly: true,\r\n\t\t\tpath: \"/\",\r\n\t\t  });\r\n\t\t  \r\n\t\t  \r\n\t\tif (dataa.status === 400 || !dataa || dataa.error) {\r\n\t\t   window.alert(\"inSuccessfull login\");\r\n        console.log(\"inSuccessfull login\");\r\n\t\t\t\r\n\t\t\r\n\t\t} else {\r\n\t\t\tconsole.log(dataa.data);\r\n\t\t\tsetUser(dataa.data);\r\n\t\t\tconsole.log(usertype);\r\n\t\t\tif(usertype==\"2\")\r\n\t\t\tnavigate(\"/home\");\r\n\t\t\telse\r\n\t\t\tnavigate(\"/adminhome\")\r\n\t\t    window.alert(\"Successfull login\");\r\n        console.log(\"Successfull login\");\r\n\t\t\r\n\t\t}\r\n\r\n\r\n\r\n    };\r\n\r\n \r\n\r\n*/\r\n\r\nconst UserStateProvider = (props) => {\r\n  const [state, setState] = useState({});\r\n\r\n  const checkLoggedIn = async () => {\r\n\t\t\t\r\n\tconst cookies = new Cookies();\r\n\tconst token = cookies.get(\"jwtoken\");\r\n\ttry {\r\n\t\tconst res = await fetch(\"http://localhost:5000/afterlogin\", {\r\n\t\tmethod: \"GET\",\r\n\t\theaders: {\r\n\t\tAccept: \"application/json\",\r\n\t\t\"Content-Type\": \"application/json\",\r\n\t\tAuthorization: `Bearer ${token}`,\r\n\t\t},\r\n\t\t\r\n\t});\r\n\tif (res.status === 401) {\r\n\r\n\t\tconst error = new Error(res.error);\r\n\t\tthrow error;\r\n\t  }\r\n\t\tconst data = await res.json();\r\n\t\t\r\n\t\tsetState({state});\r\n\t\t \r\n\t\t  \r\n\t\t\r\n\t  } catch (err) {\r\n\t\tconsole.log(err);\r\n\t\tnavigate(\"/login\");\r\n\t\t\r\n\t\t\r\n\t  }\r\n};\r\n\r\n\r\n  useEffect(() => {\r\n\tcheckLoggedIn();\r\n  }, []);\r\n\r\n  return (\r\n    <UserContext.Provider value={{state, checkLoggedIn}}>{props.children}</UserContext.Provider>\r\n  );\r\n};\r\n\r\nexport default UserStateProvider;"],"mappings":";;;AAAA;AACA,SAASA,aAAT,EAAwBC,QAAxB,EAAkCC,SAAlC,QAAmD,OAAnD;AACA,SAASC,WAAT,QAA4B,kBAA5B;AACA,OAAOC,OAAP,MAAoB,kBAApB;;AAEA,OAAO,MAAMC,WAAW,gBAAGL,aAAa,EAAjC;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAMM,iBAAiB,GAAIC,KAAD,IAAW;EAAA;;EACnC,MAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBR,QAAQ,CAAC,EAAD,CAAlC;;EAEA,MAAMS,aAAa,GAAG,YAAY;IAEnC,MAAMC,OAAO,GAAG,IAAIP,OAAJ,EAAhB;IACA,MAAMQ,KAAK,GAAGD,OAAO,CAACE,GAAR,CAAY,SAAZ,CAAd;;IACA,IAAI;MACH,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,kCAAD,EAAqC;QAC5DC,MAAM,EAAE,KADoD;QAE5DC,OAAO,EAAE;UACTC,MAAM,EAAE,kBADC;UAET,gBAAgB,kBAFP;UAGTC,aAAa,EAAG,UAASP,KAAM;QAHtB;MAFmD,CAArC,CAAvB;;MASD,IAAIE,GAAG,CAACM,MAAJ,KAAe,GAAnB,EAAwB;QAEvB,MAAMC,KAAK,GAAG,IAAIC,KAAJ,CAAUR,GAAG,CAACO,KAAd,CAAd;QACA,MAAMA,KAAN;MACE;;MACF,MAAME,IAAI,GAAG,MAAMT,GAAG,CAACU,IAAJ,EAAnB;MAEAf,QAAQ,CAAC;QAACD;MAAD,CAAD,CAAR;IAIE,CArBH,CAqBI,OAAOiB,GAAP,EAAY;MACfC,OAAO,CAACC,GAAR,CAAYF,GAAZ;MACAG,QAAQ,CAAC,QAAD,CAAR;IAGE;EACH,CA/BC;;EAkCA1B,SAAS,CAAC,MAAM;IACjBQ,aAAa;EACX,CAFQ,EAEN,EAFM,CAAT;EAIA,oBACE,QAAC,WAAD,CAAa,QAAb;IAAsB,KAAK,EAAE;MAACF,KAAD;MAAQE;IAAR,CAA7B;IAAA,UAAsDH,KAAK,CAACsB;EAA5D;IAAA;IAAA;IAAA;EAAA,QADF;AAGD,CA5CD;;GAAMvB,iB;;KAAAA,iB;AA8CN,eAAeA,iBAAf"},"metadata":{},"sourceType":"module"}
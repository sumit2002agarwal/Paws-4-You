{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\win11\\\\Desktop\\\\adopet\\\\frontend\\\\src\\\\contexts\\\\usercontext.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, createContext } from 'react';\nimport useState from 'react-usestateref';\nimport Cookies from \"universal-cookie\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst UserContext = /*#__PURE__*/createContext();\nexport const UserProvider = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const navigate = useNavigate();\n  const [currentUser, setCurrentUser, reff] = useState({\n    name: null,\n    email: null,\n    image: null\n  });\n  console.log(\"from thfhytjyauthservice\");\n  const cookies = new Cookies();\n  const token = cookies.get(\"jwtoken\");\n  useEffect(() => {\n    const checkLoggedIn = async () => {\n      try {\n        const res = await fetch(\"http://localhost:5000/afterlogin\", {\n          method: \"GET\",\n          headers: {\n            Accept: \"application/json\",\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${token}`\n          }\n        });\n\n        if (res.status === 401) {\n          const error = new Error(res.error);\n          throw error;\n        }\n\n        const data = await res.json();\n        const em = data.email;\n        const nam = data.name;\n        const img = data.image;\n        setCurrentUser({\n          name: nam,\n          email: em,\n          img\n        });\n      } catch (err) {\n        console.log(err);\n        navigate(\"/login\");\n      }\n    };\n\n    checkLoggedIn();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n    value: {\n      currentUser,\n      setCurrentUser,\n      reff\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 3\n  }, this);\n};\n\n_s(UserProvider, \"O79e55k7aAjHeMCsmMHCHsbn4F8=\", false, function () {\n  return [useNavigate];\n});\n\n_c = UserProvider;\nexport default UserContext;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserProvider\");","map":{"version":3,"names":["React","useEffect","createContext","useState","Cookies","useNavigate","UserContext","UserProvider","children","navigate","currentUser","setCurrentUser","reff","name","email","image","console","log","cookies","token","get","checkLoggedIn","res","fetch","method","headers","Accept","Authorization","status","error","Error","data","json","em","nam","img","err"],"sources":["C:/Users/win11/Desktop/adopet/frontend/src/contexts/usercontext.js"],"sourcesContent":["import React, { useEffect, createContext } from 'react';\r\nimport useState from 'react-usestateref'\r\nimport Cookies from \"universal-cookie\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nconst UserContext = createContext();\r\n\r\nexport const UserProvider = ({ children }) => {\r\n\r\n\tconst navigate = useNavigate();\r\n\tconst [ currentUser, setCurrentUser,reff ] = useState({\r\n\t\tname: null,\r\n    email: null,\r\n\timage:null,\r\n\r\n\t});\r\n\tconsole.log(\"from thfhytjyauthservice\");\r\n\tconst cookies = new Cookies();\r\n\tconst token = cookies.get(\"jwtoken\");\r\n\tuseEffect(() => {\r\n\t\tconst checkLoggedIn = async () => {\r\n\t\t\t\r\n\r\n\t\t\ttry {\r\n\t\t\t\t\t\tconst res = await fetch(\"http://localhost:5000/afterlogin\", {\r\n\t\t\t\tmethod: \"GET\",\r\n\t\t\t\theaders: {\r\n\t\t\t\tAccept: \"application/json\",\r\n\t\t\t\t\"Content-Type\": \"application/json\",\r\n\t\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\t\t},\r\n\t\t\t\t\r\n\t\t\t});\r\n\t\t\tif (res.status === 401) {\r\n      \r\n\t\t\t\tconst error = new Error(res.error);\r\n\t\t\t\tthrow error;\r\n\t\t\t  }\r\n\t\t\t\tconst data = await res.json();\r\n\t\t\t\tconst em=data.email;\r\n\t\t\t\tconst nam=data.name;\r\n\t\t\t\tconst img=data.image;\r\n\t\t\t\tsetCurrentUser({\r\n\r\n\t\t\t\t\t\tname: nam,\r\n                       email: em,\r\n\t\t\t\t\t   img\r\n\t\t\t\t\t});\r\n\t\t\t\t \r\n\t\t\t\t  \r\n\t\t\t\t\r\n\t\t\t  } catch (err) {\r\n\t\t\t\tconsole.log(err);\r\n                navigate(\"/login\");\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t  }\r\n\t\t};\r\n\r\n\t\tcheckLoggedIn();\r\n\t}, []);\r\n\r\n\t\r\n\treturn (\r\n\t\t<UserContext.Provider value={{currentUser, setCurrentUser,reff}}>\r\n\t\t\t{ children}\r\n\t\t</UserContext.Provider>\r\n\t);\r\n};\r\n\r\n\r\nexport default UserContext;"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,aAA3B,QAAgD,OAAhD;AACA,OAAOC,QAAP,MAAqB,mBAArB;AACA,OAAOC,OAAP,MAAoB,kBAApB;AACA,SAASC,WAAT,QAA4B,kBAA5B;;AACA,MAAMC,WAAW,gBAAGJ,aAAa,EAAjC;AAEA,OAAO,MAAMK,YAAY,GAAG,QAAkB;EAAA;;EAAA,IAAjB;IAAEC;EAAF,CAAiB;EAE7C,MAAMC,QAAQ,GAAGJ,WAAW,EAA5B;EACA,MAAM,CAAEK,WAAF,EAAeC,cAAf,EAA8BC,IAA9B,IAAuCT,QAAQ,CAAC;IACrDU,IAAI,EAAE,IAD+C;IAEnDC,KAAK,EAAE,IAF4C;IAGtDC,KAAK,EAAC;EAHgD,CAAD,CAArD;EAMAC,OAAO,CAACC,GAAR,CAAY,0BAAZ;EACA,MAAMC,OAAO,GAAG,IAAId,OAAJ,EAAhB;EACA,MAAMe,KAAK,GAAGD,OAAO,CAACE,GAAR,CAAY,SAAZ,CAAd;EACAnB,SAAS,CAAC,MAAM;IACf,MAAMoB,aAAa,GAAG,YAAY;MAGjC,IAAI;QACD,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,kCAAD,EAAqC;UAC9DC,MAAM,EAAE,KADsD;UAE9DC,OAAO,EAAE;YACTC,MAAM,EAAE,kBADC;YAET,gBAAgB,kBAFP;YAGTC,aAAa,EAAG,UAASR,KAAM;UAHtB;QAFqD,CAArC,CAAvB;;QASH,IAAIG,GAAG,CAACM,MAAJ,KAAe,GAAnB,EAAwB;UAEvB,MAAMC,KAAK,GAAG,IAAIC,KAAJ,CAAUR,GAAG,CAACO,KAAd,CAAd;UACA,MAAMA,KAAN;QACE;;QACF,MAAME,IAAI,GAAG,MAAMT,GAAG,CAACU,IAAJ,EAAnB;QACA,MAAMC,EAAE,GAACF,IAAI,CAACjB,KAAd;QACA,MAAMoB,GAAG,GAACH,IAAI,CAAClB,IAAf;QACA,MAAMsB,GAAG,GAACJ,IAAI,CAAChB,KAAf;QACAJ,cAAc,CAAC;UAEbE,IAAI,EAAEqB,GAFO;UAGIpB,KAAK,EAAEmB,EAHX;UAIXE;QAJW,CAAD,CAAd;MASE,CA5BH,CA4BI,OAAOC,GAAP,EAAY;QACfpB,OAAO,CAACC,GAAR,CAAYmB,GAAZ;QACY3B,QAAQ,CAAC,QAAD,CAAR;MAGV;IACH,CArCD;;IAuCAY,aAAa;EACb,CAzCQ,EAyCN,EAzCM,CAAT;EA4CA,oBACC,QAAC,WAAD,CAAa,QAAb;IAAsB,KAAK,EAAE;MAACX,WAAD;MAAcC,cAAd;MAA6BC;IAA7B,CAA7B;IAAA,UACGJ;EADH;IAAA;IAAA;IAAA;EAAA,QADD;AAKA,CA7DM;;GAAMD,Y;UAEKF,W;;;KAFLE,Y;AAgEb,eAAeD,WAAf"},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\win11\\\\Desktop\\\\adopet\\\\frontend\\\\src\\\\contexts\\\\auth.js\",\n    _s = $RefreshSig$();\n\n// dependencies\nimport { createContext, useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport Cookies from \"universal-cookie\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\n\nconst login = async (email, password, usertype) => {\n  const res = await fetch(\"http://localhost:5000/login\", {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    //credentials: 'include',\n    body: JSON.stringify({\n      email,\n      password,\n      usertype\n    })\n  });\n  const dataa = await res.json();\n  console.log(dataa);\n  cookies.set(\"jwtoken\", dataa.token, {\n    expires: new Date(Date.now() + 25892000000),\n    //httpOnly: true,\n    path: \"/\"\n  });\n\n  if (dataa.status === 400 || !dataa || dataa.error) {\n    window.alert(\"inSuccessfull login\");\n    console.log(\"inSuccessfull login\");\n  } else {\n    console.log(dataa.data);\n    setUser(dataa.data);\n    console.log(usertype);\n    if (usertype == \"2\") navigate(\"/home\");else navigate(\"/adminhome\");\n    window.alert(\"Successfull login\");\n    console.log(\"Successfull login\");\n  }\n};\n\nconst UserStateProvider = props => {\n  _s();\n\n  const [state, setState] = useState({});\n\n  const checkLoggedIn = async () => {\n    try {\n      const res = await fetch(\"http://localhost:5000/afterlogin\", {\n        method: \"GET\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`\n        }\n      });\n\n      if (res.status === 401) {\n        const error = new Error(res.error);\n        throw error;\n      }\n\n      const data = await res.json();\n      setstate({\n        state\n      });\n    } catch (err) {\n      console.log(err);\n      navigate(\"/login\");\n    }\n  };\n\n  useEffect(() => {\n    checkLoggedIn();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n    value: {\n      state,\n      checkLoggedIn\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 102,\n    columnNumber: 5\n  }, this);\n};\n\n_s(UserStateProvider, \"d/109zsnYLOF9M9RLxKBdAExSLI=\");\n\n_c = UserStateProvider;\nexport default UserStateProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserStateProvider\");","map":{"version":3,"names":["createContext","useState","useEffect","useNavigate","Cookies","AuthContext","login","email","password","usertype","res","fetch","method","headers","body","JSON","stringify","dataa","json","console","log","cookies","set","token","expires","Date","now","path","status","error","window","alert","data","setUser","navigate","UserStateProvider","props","state","setState","checkLoggedIn","Accept","Authorization","Error","setstate","err","children"],"sources":["C:/Users/win11/Desktop/adopet/frontend/src/contexts/auth.js"],"sourcesContent":["// dependencies\r\nimport { createContext, useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport Cookies from \"universal-cookie\";\r\nexport const AuthContext = createContext();\r\n\r\n\r\n\r\n    const login = async(email, password,usertype) => {\r\n\r\n        const res = await fetch(\"http://localhost:5000/login\", {\r\n\t\t  method: \"POST\",\r\n\t\t  headers: {\r\n\t\t\t\"Content-Type\": \"application/json\",\r\n\t\t  },\r\n\t\t  //credentials: 'include',\r\n\t\t  body: JSON.stringify({\r\n\t\t\temail,\r\n\t\t\tpassword,\r\n\t\t\tusertype\r\n\t\t  }),\r\n\t\t});\r\n\t\r\n\t\tconst dataa = await res.json();\r\n       \r\n         console.log(dataa);\r\n\t\t\r\n\t\t cookies.set(\"jwtoken\", dataa.token, {\r\n\t\t\texpires: new Date(Date.now() + 25892000000),\r\n\t\t\t//httpOnly: true,\r\n\t\t\tpath: \"/\",\r\n\t\t  });\r\n\t\t  \r\n\t\t  \r\n\t\tif (dataa.status === 400 || !dataa || dataa.error) {\r\n\t\t   window.alert(\"inSuccessfull login\");\r\n        console.log(\"inSuccessfull login\");\r\n\t\t\t\r\n\t\t\r\n\t\t} else {\r\n\t\t\tconsole.log(dataa.data);\r\n\t\t\tsetUser(dataa.data);\r\n\t\t\tconsole.log(usertype);\r\n\t\t\tif(usertype==\"2\")\r\n\t\t\tnavigate(\"/home\");\r\n\t\t\telse\r\n\t\t\tnavigate(\"/adminhome\")\r\n\t\t    window.alert(\"Successfull login\");\r\n        console.log(\"Successfull login\");\r\n\t\t\r\n\t\t}\r\n\r\n\r\n\r\n    };\r\n\r\n \r\n\r\n\r\n\r\nconst UserStateProvider = (props) => {\r\n  const [state, setState] = useState({});\r\n\r\n  const checkLoggedIn = async () => {\r\n\t\t\t\r\n\r\n\ttry {\r\n\t\tconst res = await fetch(\"http://localhost:5000/afterlogin\", {\r\n\t\tmethod: \"GET\",\r\n\t\theaders: {\r\n\t\tAccept: \"application/json\",\r\n\t\t\"Content-Type\": \"application/json\",\r\n\t\tAuthorization: `Bearer ${token}`,\r\n\t\t},\r\n\t\t\r\n\t});\r\n\tif (res.status === 401) {\r\n\r\n\t\tconst error = new Error(res.error);\r\n\t\tthrow error;\r\n\t  }\r\n\t\tconst data = await res.json();\r\n\t\t\r\n\t\tsetstate({state});\r\n\t\t \r\n\t\t  \r\n\t\t\r\n\t  } catch (err) {\r\n\t\tconsole.log(err);\r\n\t\tnavigate(\"/login\");\r\n\t\t\r\n\t\t\r\n\t  }\r\n};\r\n\r\n\r\n  useEffect(() => {\r\n\tcheckLoggedIn();\r\n  }, []);\r\n\r\n  return (\r\n    <UserContext.Provider value={{state, checkLoggedIn}}>{props.children}</UserContext.Provider>\r\n  );\r\n};\r\n\r\nexport default UserStateProvider;"],"mappings":"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"},"metadata":{},"sourceType":"module"}